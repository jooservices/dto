name: Secret Scanning

on:
  # Run on every push and PR
  push:
    branches: [master, develop]
  pull_request:
  # Weekly scheduled scan of entire history
  schedule:
    - cron: '0 0 * * 0'  # Every Sunday at midnight UTC
  # Allow manual trigger
  workflow_dispatch:

# Cancel in-progress runs when a new run is triggered
concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  # Temporarily disabled - can be re-enabled when GITLEAKS_LICENSE is configured
  # gitleaks:
  #   name: Gitleaks Secret Scan
  #   runs-on: ubuntu-latest
  #   continue-on-error: true  # Optional: requires GITLEAKS_LICENSE for organizations
  #   steps:
  #     - name: Checkout code
  #       uses: actions/checkout@v4
  #       with:
  #         fetch-depth: 0  # Full git history for comprehensive scan
  #
  #     - name: Run Gitleaks
  #       uses: gitleaks/gitleaks-action@v2
  #       env:
  #         GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
  #         GITLEAKS_LICENSE: ${{ secrets.GITLEAKS_LICENSE }}
  #         GITLEAKS_ENABLE_COMMENTS: true
  #       # Note: For organizations, Gitleaks requires a license key stored as GITLEAKS_LICENSE secret
  #       # If not configured, this step will fail but won't block CI (continue-on-error: true)
